<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Schrödinger Equation Solver · QuantumToolbox.jl</title><meta name="title" content="Schrödinger Equation Solver · QuantumToolbox.jl"/><meta property="og:title" content="Schrödinger Equation Solver · QuantumToolbox.jl"/><meta property="twitter:title" content="Schrödinger Equation Solver · QuantumToolbox.jl"/><meta name="description" content="Documentation for QuantumToolbox.jl."/><meta property="og:description" content="Documentation for QuantumToolbox.jl."/><meta property="twitter:description" content="Documentation for QuantumToolbox.jl."/><meta property="og:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/sesolve/"/><meta property="twitter:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/sesolve/"/><link rel="canonical" href="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/sesolve/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="QuantumToolbox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">QuantumToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../qutip_differences/">Key differences from QuTiP</a></li><li><a class="tocitem" href="../../../type_stability/">The Importance of Type-Stability</a></li></ul></li><li><span class="tocitem">Users Guide</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Basic Operations on Quantum Objects</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QuantumObject/QuantumObject/">Quantum Objects (Qobj)</a></li><li><a class="tocitem" href="../../QuantumObject/QuantumObject_functions/">Functions operating on Qobj</a></li></ul></li><li><a class="tocitem" href="../../states_and_operators/">Manipulating States and Operators</a></li><li><a class="tocitem" href="../../tensor/">Tensor Products and Partial Traces</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Time Evolution and Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../solution/">Time Evolution Solutions</a></li><li class="is-active"><a class="tocitem" href>Schrödinger Equation Solver</a><ul class="internal"><li><a class="tocitem" href="#Unitary-evolution"><span>Unitary evolution</span></a></li><li><a class="tocitem" href="#Example:-Spin-dynamics"><span>Example: Spin dynamics</span></a></li></ul></li><li><a class="tocitem" href="../mesolve/">Lindblad Master Equation Solver</a></li><li><a class="tocitem" href="../mcsolve/">Monte-Carlo Solver</a></li><li><a class="tocitem" href="../stochastic/">Stochastic Solver</a></li><li><a class="tocitem" href="../time_dependent/">Solving Problems with Time-dependent Hamiltonians</a></li></ul></li><li><a class="tocitem" href="../../steadystate/">Solving for Steady-State Solutions</a></li><li><span class="tocitem">Symmetries</span></li><li><span class="tocitem">Two-time correlation functions</span></li><li><input class="collapse-toggle" id="menuitem-2-8" type="checkbox"/><label class="tocitem" for="menuitem-2-8"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../extensions/cuda/">Extension for CUDA.jl</a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Time Evolution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/lowrank/">Low Rank Master Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Miscellaneous Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/logo/">Create QuantumToolbox.jl logo</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Users Guide</a></li><li><a class="is-disabled">Time Evolution and Dynamics</a></li><li class="is-active"><a href>Schrödinger Equation Solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Schrödinger Equation Solver</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl/blob/main/docs/src/users_guide/time_evolution/sesolve.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-TE:Schrödinger-Equation-Solver"><a class="docs-heading-anchor" href="#doc-TE:Schrödinger-Equation-Solver">Schrödinger Equation Solver</a><a id="doc-TE:Schrödinger-Equation-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#doc-TE:Schrödinger-Equation-Solver" title="Permalink"></a></h1><h2 id="Unitary-evolution"><a class="docs-heading-anchor" href="#Unitary-evolution">Unitary evolution</a><a id="Unitary-evolution-1"></a><a class="docs-heading-anchor-permalink" href="#Unitary-evolution" title="Permalink"></a></h2><p>The dynamics of a closed (pure) quantum system is governed by the Schrödinger equation</p><p class="math-container">\[i\hbar\frac{\partial}{\partial t}\Psi(\vec{x}, t) = \hat{H}\Psi(\vec{x}, t),\]</p><p>where <span>$\Psi(\vec{x}, t)$</span> is the wave function, <span>$\hat{H}$</span> is the Hamiltonian, and <span>$\hbar$</span> is reduced Planck constant. In general, the Schrödinger equation is a partial differential equation (PDE) where both  <span>$\Psi$</span> and <span>$\hat{H}$</span> are functions of space <span>$\vec{x}$</span> and time <span>$t$</span>. For computational purposes it is useful to expand the PDE in a set of basis functions that span the Hilbert space of the Hamiltonian, and to write the equation in matrix and vector form, namely</p><p class="math-container">\[i\hbar\frac{d}{dt}|\psi(t)\rangle = \hat{H}|\psi(t)\rangle,\]</p><p>where <span>$|\psi(t)\rangle$</span> is the state vector, and the Hamiltonian <span>$\hat{H}$</span> is now under matrix representation. This matrix equation can, in principle, be solved by diagonalizing the Hamiltonian matrix <span>$\hat{H}$</span>. In practice, however, it is difficult to perform this diagonalization unless the size of the Hilbert space (dimension of the matrix <span>$\hat{H}$</span>) is small. Analytically, it is a formidable task to calculate the dynamics for systems with more than two states. If, in addition, we consider dissipation due to the inevitable interaction with a surrounding environment, the computational complexity grows even larger, and we have to resort to numerical calculations in all realistic situations. This illustrates the importance of numerical calculations in describing the dynamics of open quantum systems, and the need for efficient and accessible tools for this task.</p><p>The Schrödinger equation, which governs the time-evolution of closed quantum systems, is defined by its Hamiltonian and state vector. In the previous sections, <a href="../../states_and_operators/#doc:Manipulating-States-and-Operators">Manipulating States and Operators</a> and <a href="../../tensor/#doc:Tensor-products-and-Partial-Traces">Tensor Products and Partial Traces</a>, we showed how Hamiltonians and state vectors are constructed in <code>QuantumToolbox.jl</code>. Given a Hamiltonian, we can calculate the unitary (non-dissipative) time-evolution of an arbitrary initial state vector <span>$|\psi(0)\rangle$</span> using the <code>QuantumToolbox</code> time evolution problem <a href="../../../api/#QuantumToolbox.sesolveProblem"><code>sesolveProblem</code></a> or directly call the function <a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a>. It evolves the state vector <span>$|\psi(t)\rangle$</span> and evaluates the expectation values for a set of operators <code>e_ops</code> at each given time points, using an ordinary differential equation solver provided by the powerful julia package <a href="https://docs.sciml.ai/DiffEqDocs/stable/"><code>DifferentialEquation.jl</code></a>.</p><h2 id="Example:-Spin-dynamics"><a class="docs-heading-anchor" href="#Example:-Spin-dynamics">Example: Spin dynamics</a><a id="Example:-Spin-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Spin-dynamics" title="Permalink"></a></h2><p>For example, the time evolution of a quantum spin-<span>$\frac{1}{2}$</span> system (initialized in spin-<span>$\uparrow$</span>) with tunneling rate <span>$0.1$</span> is calculated, and the expectation values of the Pauli-Z operator <span>$\hat{\sigma}_z$</span> is also evaluated, with the following code</p><pre><code class="language-julia hljs">H = 2 * π * 0.1 * sigmax()
ψ0 = basis(2, 0) # spin-up
tlist = LinRange(0.0, 10.0, 20)

prob = sesolveProblem(H, ψ0, tlist, e_ops = [sigmaz()])
sol = sesolve(prob)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 1
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Here, we generate the time evolution problem by <a href="../../../api/#QuantumToolbox.sesolveProblem"><code>sesolveProblem</code></a> first and then put it into the function <a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a>. One can also directly call <a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a>, which we also demonstrates in below.</p></div></div><p>The function returns <a href="../../../api/#QuantumToolbox.TimeEvolutionSol"><code>TimeEvolutionSol</code></a>, as described in the previous section <a href="../solution/#doc-TE:Time-Evolution-Solutions">Time Evolution Solutions</a>. The attribute <code>expect</code> in <code>sol</code>ution is a list of expectation values for the operator(s) that are passed to the <code>e_ops</code> keyword argument. </p><pre><code class="language-julia hljs">sol.expect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×20 Matrix{ComplexF64}:
 1.0+0.0im  0.789141+0.0im  0.245485+0.0im  …  0.789141+0.0im  1.0+0.0im</code></pre><p>Passing multiple operators to <code>e_ops</code> as a <code>Vector</code> results in the expectation values for each operators at each time points.</p><pre><code class="language-julia hljs">tlist = LinRange(0.0, 10.0, 100)
sol = sesolve(H, ψ0, tlist, e_ops = [sigmaz(), sigmay()])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 2
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Here, we call <a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a> directly instead of pre-defining <a href="../../../api/#QuantumToolbox.sesolveProblem"><code>sesolveProblem</code></a> first (as shown previously).</p></div></div><pre><code class="language-julia hljs">times = sol.times
print(size(times))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(100,)</code></pre><pre><code class="language-julia hljs">expt = sol.expect
print(size(expt))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(2, 100)</code></pre><p>We can therefore plot the expectation values:</p><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.enable_only_mime!(MIME&quot;image/svg+xml&quot;())

expt_z = real(expt[1,:])
expt_y = real(expt[2,:])

fig = Figure(size = (500, 350))
ax = Axis(fig[1, 1], xlabel = &quot;Time&quot;, ylabel = &quot;Expectation values&quot;)
lines!(ax, times, expt_z, label = L&quot;\langle\hat{\sigma}_z\rangle&quot;, linestyle = :solid)
lines!(ax, times, expt_y, label = L&quot;\langle\hat{\sigma}_y\rangle&quot;, linestyle = :dash)

axislegend(ax, position = :rb)

fig</code></pre><img src="a1939615.svg" alt="Example block output"/><p>If the keyword argument <code>e_ops</code> is not specified (or given as an empty <code>Vector</code>), the <a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a> and functions return a <a href="../../../api/#QuantumToolbox.TimeEvolutionSol"><code>TimeEvolutionSol</code></a> that contains a list of state vectors which corresponds to the time points specified in <code>tlist</code>:</p><pre><code class="language-julia hljs">tlist = [0, 10]
sol = sesolve(H, ψ0, tlist) # or specify: e_ops = []

sol.states</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{QuantumObject{Vector{ComplexF64}, KetQuantumObject, 1}}:
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 1.0 + 0.0im
 0.0 + 0.0im
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 0.9999999543220187 + 0.0im
                0.0 - 5.6377384923229734e-8im</code></pre><p>This is because the <code>states</code> will be saved depend on the keyword argument <code>saveat</code> in <code>kwargs</code>. If <code>e_ops</code> is empty, the default value of <code>saveat=tlist</code> (saving the states corresponding to <code>tlist</code>), otherwise, <code>saveat=[tlist[end]]</code> (only save the final state). </p><p>One can also specify <code>e_ops</code> and <code>saveat</code> separately:</p><pre><code class="language-julia hljs">tlist = [0, 5, 10]
sol = sesolve(H, ψ0, tlist, e_ops = [sigmay()], saveat = tlist)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 3
num_expect = 1
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><pre><code class="language-julia hljs">sol.expect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×3 Matrix{ComplexF64}:
 0.0+0.0im  -3.85604e-8+0.0im  -8.84188e-8+0.0im</code></pre><pre><code class="language-julia hljs">sol.states</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{QuantumObject{Vector{ComplexF64}, KetQuantumObject, 1}}:
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 1.0 + 0.0im
 0.0 + 0.0im
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 -0.9999999835117516 + 0.0im
                 0.0 + 1.9280202194539866e-8im
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 0.9999999627203567 + 0.0im
                0.0 - 4.4209406791454714e-8im</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solution/">« Time Evolution Solutions</a><a class="docs-footer-nextpage" href="../mesolve/">Lindblad Master Equation Solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Tuesday 29 October 2024 01:19">Tuesday 29 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
