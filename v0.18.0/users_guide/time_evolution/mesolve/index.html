<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lindblad Master Equation Solver · QuantumToolbox.jl</title><meta name="title" content="Lindblad Master Equation Solver · QuantumToolbox.jl"/><meta property="og:title" content="Lindblad Master Equation Solver · QuantumToolbox.jl"/><meta property="twitter:title" content="Lindblad Master Equation Solver · QuantumToolbox.jl"/><meta name="description" content="Documentation for QuantumToolbox.jl."/><meta property="og:description" content="Documentation for QuantumToolbox.jl."/><meta property="twitter:description" content="Documentation for QuantumToolbox.jl."/><meta property="og:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/mesolve/"/><meta property="twitter:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/mesolve/"/><link rel="canonical" href="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/mesolve/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="QuantumToolbox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">QuantumToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../qutip_differences/">Key differences from QuTiP</a></li><li><a class="tocitem" href="../../../type_stability/">The Importance of Type-Stability</a></li></ul></li><li><span class="tocitem">Users Guide</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Basic Operations on Quantum Objects</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QuantumObject/QuantumObject/">Quantum Objects (Qobj)</a></li><li><a class="tocitem" href="../../QuantumObject/QuantumObject_functions/">Functions operating on Qobj</a></li></ul></li><li><a class="tocitem" href="../../states_and_operators/">Manipulating States and Operators</a></li><li><a class="tocitem" href="../../tensor/">Tensor Products and Partial Traces</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Time Evolution and Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../solution/">Time Evolution Solutions</a></li><li><a class="tocitem" href="../sesolve/">Schrödinger Equation Solver</a></li><li class="is-active"><a class="tocitem" href>Lindblad Master Equation Solver</a><ul class="internal"><li><a class="tocitem" href="#Von-Neumann-equation"><span>Von Neumann equation</span></a></li><li><a class="tocitem" href="#The-Lindblad-master-equation"><span>The Lindblad master equation</span></a></li><li><a class="tocitem" href="#Example:-Spin-dynamics"><span>Example: Spin dynamics</span></a></li><li><a class="tocitem" href="#Example:-Harmonic-oscillator-in-thermal-bath"><span>Example: Harmonic oscillator in thermal bath</span></a></li><li><a class="tocitem" href="#Example:-Two-level-atom-coupled-to-dissipative-single-mode-cavity"><span>Example: Two-level atom coupled to dissipative single-mode cavity</span></a></li></ul></li><li><a class="tocitem" href="../mcsolve/">Monte-Carlo Solver</a></li><li><a class="tocitem" href="../stochastic/">Stochastic Solver</a></li><li><a class="tocitem" href="../time_dependent/">Solving Problems with Time-dependent Hamiltonians</a></li></ul></li><li><a class="tocitem" href="../../steadystate/">Solving for Steady-State Solutions</a></li><li><span class="tocitem">Symmetries</span></li><li><span class="tocitem">Two-time correlation functions</span></li><li><input class="collapse-toggle" id="menuitem-2-8" type="checkbox"/><label class="tocitem" for="menuitem-2-8"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../extensions/cuda/">Extension for CUDA.jl</a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Time Evolution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/lowrank/">Low Rank Master Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Miscellaneous Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/logo/">Create QuantumToolbox.jl logo</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Users Guide</a></li><li><a class="is-disabled">Time Evolution and Dynamics</a></li><li class="is-active"><a href>Lindblad Master Equation Solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lindblad Master Equation Solver</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl/blob/main/docs/src/users_guide/time_evolution/mesolve.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-TE:Lindblad-Master-Equation-Solver"><a class="docs-heading-anchor" href="#doc-TE:Lindblad-Master-Equation-Solver">Lindblad Master Equation Solver</a><a id="doc-TE:Lindblad-Master-Equation-Solver-1"></a><a class="docs-heading-anchor-permalink" href="#doc-TE:Lindblad-Master-Equation-Solver" title="Permalink"></a></h1><h2 id="Von-Neumann-equation"><a class="docs-heading-anchor" href="#Von-Neumann-equation">Von Neumann equation</a><a id="Von-Neumann-equation-1"></a><a class="docs-heading-anchor-permalink" href="#Von-Neumann-equation" title="Permalink"></a></h2><p>While the evolution of the state vector in a closed quantum system is deterministic (as we discussed in the previous section: <a href="../sesolve/#doc-TE:Schrödinger-Equation-Solver">Schrödinger Equation Solver</a>), open quantum systems are stochastic in nature. The effect of an environment on the system of interest is to induce stochastic transitions between energy levels, and to introduce uncertainty in the phase difference between states of the system. The state of an open quantum system is therefore described in terms of ensemble averaged states using the density matrix formalism. A density matrix <span>$\hat{\rho}$</span> describes a probability distribution of quantum states <span>$|\psi_n\rangle$</span> in a matrix representation, namely</p><p class="math-container">\[\hat{\rho} = \sum_n p_n |\psi_n\rangle\langle\psi_n|,\]</p><p>where <span>$p_n$</span> is the classical probability that the system is in the quantum state <span>$|\psi_n\rangle$</span>. The time evolution of a density matrix <span>$\hat{\rho}$</span> is the topic of the remaining portions of this section.</p><p>The time evolution of the density matrix <span>$\hat{\rho}(t)$</span> under closed system dynamics is governed by the von Neumann equation: </p><p class="math-container">\[\begin{equation}
\label{von-Neumann-Eq}
\frac{d}{dt}\hat{\rho}(t) = -\frac{i}{\hbar}\left[\hat{H}, \hat{\rho}(t)\right],
\end{equation}\]</p><p>where <span>$[\cdot, \cdot]$</span> represents the commutator. The above equation is equivalent to the Schrödinger equation described in the <a href="../sesolve/#doc-TE:Schrödinger-Equation-Solver">previous section</a> under the density matrix formalism.</p><p>In <code>QuantumToolbox</code>, given a Hamiltonian, we can calculate the unitary (non-dissipative) time-evolution of an arbitrary initial state using the <code>QuantumToolbox</code> time evolution problem <a href="../../../api/#QuantumToolbox.mesolveProblem"><code>mesolveProblem</code></a> or directly call the function <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a>. It evolves the density matrix <span>$\hat{\rho}(t)$</span> and evaluates the expectation values for a set of operators <code>e_ops</code> at each given time points, using an ordinary differential equation solver provided by the powerful julia package <a href="https://docs.sciml.ai/DiffEqDocs/stable/"><code>DifferentialEquation.jl</code></a>.</p><pre><code class="language-julia hljs">H = 0.5 * sigmax()
state0 = basis(2, 0)         # state vector
state0 = ket2dm(basis(2, 0)) # density matrix
tlist = LinRange(0.0, 10.0, 20)

sol = mesolve(H, state0, tlist, e_ops = [sigmaz()])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 1
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><div class="admonition is-info"><header class="admonition-header">Type of initial state</header><div class="admonition-body"><p>The initial state <code>state0</code> here can be given as a state vector <span>$|\psi(0)\rangle$</span> (in the type of <a href="../../../api/#QuantumToolbox.Ket"><code>Ket</code></a>) or a density matrix <span>$\hat{\rho}(0)$</span> (in the type of <a href="../../../api/#QuantumToolbox.Operator"><code>Operator</code></a>). If it is given as a <a href="../../../api/#QuantumToolbox.Ket"><code>Ket</code></a>, it will be transformed to density matrix <span>$\hat{\rho}(0) = |\psi(0)\rangle\langle\psi(0)|$</span> internally in <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a>.</p></div></div><p>The function returns <a href="../../../api/#QuantumToolbox.TimeEvolutionSol"><code>TimeEvolutionSol</code></a>, as described in the previous section <a href="../solution/#doc-TE:Time-Evolution-Solutions">Time Evolution Solutions</a>. The stored <code>states</code> will always be in the type of <a href="../../../api/#QuantumToolbox.Operator"><code>Operator</code></a> (density matrix).</p><pre><code class="language-julia hljs">sol.states</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{QuantumObject{Matrix{ComplexF64}, OperatorQuantumObject, 1}}:
 Quantum Object:   type=Operator   dims=[2]   size=(2, 2)   ishermitian=true
2×2 Matrix{ComplexF64}:
 0.0804642+0.0im            0.0-0.272011im
       0.0+0.272011im  0.919536+0.0im</code></pre><p>Here, only the final state is stored because the <code>states</code> will be saved depend on the keyword argument <code>saveat</code> in <code>kwargs</code>. If <code>e_ops</code> is empty, the default value of <code>saveat=tlist</code> (saving the states corresponding to <code>tlist</code>), otherwise, <code>saveat=[tlist[end]]</code> (only save the final state). </p><p>One can also specify <code>e_ops</code> and <code>saveat</code> separately:</p><pre><code class="language-julia hljs">tlist = [0, 5, 10]
sol = mesolve(H, state0, tlist, e_ops = [sigmay()], saveat = tlist)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 3
num_expect = 1
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><pre><code class="language-julia hljs">sol.expect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1×3 Matrix{ComplexF64}:
 0.0+0.0im  0.958924+0.0im  0.544021+0.0im</code></pre><pre><code class="language-julia hljs">sol.states</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{QuantumObject{Matrix{ComplexF64}, OperatorQuantumObject, 1}}:
 Quantum Object:   type=Operator   dims=[2]   size=(2, 2)   ishermitian=true
2×2 Matrix{ComplexF64}:
 1.0+0.0im  0.0+0.0im
 0.0+0.0im  0.0+0.0im
 Quantum Object:   type=Operator   dims=[2]   size=(2, 2)   ishermitian=true
2×2 Matrix{ComplexF64}:
 0.641831+0.0im            0.0-0.479462im
      0.0+0.479462im  0.358169+0.0im
 Quantum Object:   type=Operator   dims=[2]   size=(2, 2)   ishermitian=true
2×2 Matrix{ComplexF64}:
 0.0804643+0.0im            0.0-0.272011im
       0.0+0.272011im  0.919536+0.0im</code></pre><h2 id="The-Lindblad-master-equation"><a class="docs-heading-anchor" href="#The-Lindblad-master-equation">The Lindblad master equation</a><a id="The-Lindblad-master-equation-1"></a><a class="docs-heading-anchor-permalink" href="#The-Lindblad-master-equation" title="Permalink"></a></h2><p>The standard approach for deriving the equations of motion for a system interacting with its environment is to expand the scope of the system to include the environment. The combined quantum system is then closed, and its evolution is governed by the von Neumann equation given in Eq. \eqref{von-Neumann-Eq}</p><p class="math-container">\[\begin{equation}
\label{tot-von-Neumann-Eq}
\frac{d}{dt}\hat{\rho}_{\textrm{tot}}(t) = -\frac{i}{\hbar}\left[\hat{H}_{\textrm{tot}}, \hat{\rho}_{\textrm{tot}}(t)\right].
\end{equation}\]</p><p>Here, the total Hamiltonian</p><p class="math-container">\[\hat{H}_{\textrm{tot}} = \hat{H}_{\textrm{sys}} + \hat{H}_{\textrm{env}} + \hat{H}_{\textrm{int}},\]</p><p>includes the original system Hamiltonian <span>$\hat{H}_{\textrm{sys}}$</span>, the Hamiltonian for the environment <span>$\hat{H}_{\textrm{env}}$</span>, and a term representing the interaction between the system and its environment <span>$\hat{H}_{\textrm{int}}$</span>. Since we are only interested in the dynamics of the system, we can, perform a partial trace over the environmental degrees of freedom in Eq. \eqref{tot-von-Neumann-Eq}, and thereby obtain a master equation for the motion of the original system density matrix <span>$\hat{\rho}_{\textrm{sys}}(t)=\textrm{Tr}_{\textrm{env}}[\hat{\rho}_{\textrm{tot}}(t)]$</span>. The most general trace-preserving and completely positive form of this evolution is the Lindblad master equation for the reduced density matrix, namely</p><p class="math-container">\[\begin{equation}
\label{Lindblad-master-Eq}
\frac{d}{dt}\hat{\rho}_{\textrm{sys}}(t) = -\frac{i}{\hbar}\left[\hat{H}_{\textrm{sys}}, \hat{\rho}_{\textrm{sys}}(t)\right] + \sum_n \hat{C}_n \hat{\rho}_{\textrm{sys}}(t) \hat{C}_n^\dagger - \frac{1}{2} \hat{C}_n^\dagger \hat{C}_n \hat{\rho}_{\textrm{sys}}(t) - \frac{1}{2} \hat{\rho}_{\textrm{sys}}(t) \hat{C}_n^\dagger \hat{C}_n
\end{equation}\]</p><p>where <span>$\hat{C}_n \equiv \sqrt{\gamma_n}\hat{A}_n$</span> are the collapse operators, <span>$\hat{A}_n$</span> are the operators acting on the system in <span>$\hat{H}_{\textrm{int}}$</span> which describes the system-environment interaction, and <span>$\gamma_n$</span> are the corresponding rates. The derivation of Eq. \eqref{Lindblad-master-Eq} may be found in several sources, and will not be reproduced here. Instead, we emphasize the approximations that are required to arrive at the master equation in the form of Eq. \eqref{Lindblad-master-Eq} from physical arguments, and hence perform a calculation in <code>QuantumToolbox</code>:</p><ul><li><strong>Separability:</strong> At <span>$t = 0$</span>, there are no correlations between the system and environment, such that the total density matrix can be written as a tensor product, namely <span>$\hat{\rho}_{\textrm{tot}}(0)=\hat{\rho}_{\textrm{sys}}(0)\otimes\hat{\rho}_{\textrm{env}}(0)$</span>.</li><li><strong>Born approximation:</strong> Requires: (i) the state of the environment does not significantly change as a result of the interaction with the system; (ii) the system and the environment remain separable throughout the evolution. These assumptions are justified if the interaction is weak, and if the environment is much larger than the system. In summary, <span>$\hat{\rho}_{\textrm{tot}}(t)\approx\hat{\rho}_{\textrm{sys}}(t)\otimes\hat{\rho}_{\textrm{env}}(0)$</span>.</li><li><strong>Markov approximation:</strong> The time-scale of decay for the environment <span>$\tau_{\textrm{env}}$</span> is much shorter than the smallest time-scale of the system dynamics, i.e., <span>$\tau_{\textrm{sys}}\gg\tau_{\textrm{env}}$</span>. This approximation is often deemed a “short-memory environment” as it requires the environmental correlation functions decay in a fast time-scale compared to those of the system.</li><li><strong>Secular approximation:</strong> Stipulates that elements in the master equation corresponding to transition frequencies satisfy <span>$|\omega_{ab}-\omega_{cd}| \ll 1/\tau_{\textrm{sys}}$</span>, i.e., all fast rotating terms in the interaction picture can be neglected. It also ignores terms that lead to a small renormalization of the system energy levels. This approximation is not strictly necessary for all master-equation formalisms (e.g., the Block-Redfield master equation), but it is required for arriving at the Lindblad form in Eq. \eqref{Lindblad-master-Eq} which is used in <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a>.</li></ul><p>For systems with environments satisfying the conditions outlined above, the Lindblad master equation in Eq. \eqref{Lindblad-master-Eq} governs the time-evolution of the system density matrix, giving an ensemble average of the system dynamics. In order to ensure that these approximations are not violated, it is important that the decay rates <span>$\gamma_n$</span> be smaller than the minimum energy splitting in the system Hamiltonian. Situations that demand special attention therefore include, for example, systems strongly coupled to their environment, and systems with degenerate or nearly degenerate energy levels.</p><p>What is new in the master equation compared to the Schrödinger equation (or von Neumann equation) are processes that describe dissipation in the quantum system due to its interaction with an environment. For example, evolution that includes incoherent processes such as relaxation and dephasing. These environmental interactions are defined by the operators <span>$\hat{A}_n$</span> through which the system couples to the environment, and rates <span>$\gamma_n$</span> that describe the strength of the processes.</p><p>In <code>QuantumToolbox</code>, the function <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> can also be used for solving the master equation. This is done by passing a list of collapse operators (<code>c_ops</code>) as the fourth argument of the <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> function in order to define the dissipation processes of the master equation in Eq. \eqref{Lindblad-master-Eq}. As we mentioned above, each collapse operator <span>$\hat{C}_n$</span> is the product of <span>$\sqrt{\gamma_n}$</span> (the square root of the rate) and <span>$\hat{A}_n$</span> (operator which describes the dissipation process). </p><p>Furthermore, <code>QuantumToolbox</code> solves the master equation in the <a href="../../../api/#QuantumToolbox.SuperOperator"><code>SuperOperator</code></a> formalism. That is, a Liouvillian <a href="../../../api/#QuantumToolbox.SuperOperator"><code>SuperOperator</code></a> will be generated internally in <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> by the input system Hamiltonian <span>$\hat{H}_{\textrm{sys}}$</span> and the collapse operators <span>$\hat{C}_n$</span>. One can also generate the Liouvillian <a href="../../../api/#QuantumToolbox.SuperOperator"><code>SuperOperator</code></a> manually for special purposes, and pass it as the first argument of the <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> function. To do so, it is useful to read the section <a href="../../states_and_operators/#doc:Superoperators-and-Vectorized-Operators">Superoperators and Vectorized Operators</a>, and also the docstrings of the following functions:</p><ul><li><a href="../../../api/#QuantumToolbox.spre"><code>spre</code></a></li><li><a href="../../../api/#QuantumToolbox.spost"><code>spost</code></a></li><li><a href="../../../api/#QuantumToolbox.sprepost"><code>sprepost</code></a></li><li><a href="../../../api/#QuantumToolbox.liouvillian"><code>liouvillian</code></a></li><li><a href="../../../api/#QuantumToolbox.lindblad_dissipator"><code>lindblad_dissipator</code></a></li></ul><h2 id="Example:-Spin-dynamics"><a class="docs-heading-anchor" href="#Example:-Spin-dynamics">Example: Spin dynamics</a><a id="Example:-Spin-dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Spin-dynamics" title="Permalink"></a></h2><p>Using the example with the dynamics of spin-<span>$\frac{1}{2}$</span> from the previous section (<a href="../sesolve/#doc-TE:Schrödinger-Equation-Solver">Schrödinger Equation Solver</a>), we can easily add a relaxation process (describing the dissipation of energy from the spin to the environment), by adding <code>[sqrt(γ) * sigmax()]</code> in the fourth parameter of the <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> function.</p><pre><code class="language-julia hljs">H = 2 * π * 0.1 * sigmax()
ψ0 = basis(2, 0) # spin-up
tlist = LinRange(0.0, 10.0, 100)

γ = 0.05
c_ops = [sqrt(γ) * sigmax()]

sol = mesolve(H, ψ0, tlist, c_ops, e_ops = [sigmaz(), sigmay()])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 2
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6
</code></pre><p>We can therefore plot the expectation values:</p><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.enable_only_mime!(MIME&quot;image/svg+xml&quot;())

times = sol.times
expt_z = real(sol.expect[1,:])
expt_y = real(sol.expect[2,:])

fig = Figure(size = (500, 350))
ax = Axis(fig[1, 1], xlabel = &quot;Time&quot;, ylabel = &quot;Expectation values&quot;)
lines!(ax, times, expt_z, label = L&quot;\langle\hat{\sigma}_z\rangle&quot;, linestyle = :solid)
lines!(ax, times, expt_y, label = L&quot;\langle\hat{\sigma}_y\rangle&quot;, linestyle = :dash)

axislegend(ax, position = :rt)

fig</code></pre><img src="c225fda5.svg" alt="Example block output"/><h2 id="Example:-Harmonic-oscillator-in-thermal-bath"><a class="docs-heading-anchor" href="#Example:-Harmonic-oscillator-in-thermal-bath">Example: Harmonic oscillator in thermal bath</a><a id="Example:-Harmonic-oscillator-in-thermal-bath-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Harmonic-oscillator-in-thermal-bath" title="Permalink"></a></h2><p>Consider a harmonic oscillator (single-mode cavity) couples to a thermal bath. If the single-mode cavity initially is in a <code>10</code>-photon <a href="../../../api/#QuantumToolbox.fock"><code>fock</code></a> state, the dynamics is calculated with the following code:</p><pre><code class="language-julia hljs"># Define parameters
N = 20  # number of basis states to consider
a = destroy(N)
H = a&#39; * a
ψ0 = fock(N, 10)  # initial state
κ = 0.1  # coupling to oscillator
n_th = 2 # temperature with average of 2 excitations
tlist = LinRange(0, 50, 100)

# collapse operators
c_ops = [
    sqrt(κ * (n_th + 1)) * a, # emission
    sqrt(κ *  n_th     ) * a&#39; # absorption
]

# find expectation value for particle number
e_ops = [a&#39; * a]

sol = mesolve(H, ψ0, tlist, c_ops, e_ops=e_ops)
Num = real(sol.expect[1, :])

# plot the results
fig = Figure(size = (500, 350))
ax = Axis(fig[1, 1],
    title = L&quot;Decay of Fock state $|10\rangle$ in a thermal environment with $\langle n\rangle=2$&quot;,
    xlabel = &quot;Time&quot;,
    ylabel = &quot;Number of excitations&quot;,
)
lines!(ax, tlist, Num)

fig</code></pre><img src="c6ed35fc.svg" alt="Example block output"/><h2 id="Example:-Two-level-atom-coupled-to-dissipative-single-mode-cavity"><a class="docs-heading-anchor" href="#Example:-Two-level-atom-coupled-to-dissipative-single-mode-cavity">Example: Two-level atom coupled to dissipative single-mode cavity</a><a id="Example:-Two-level-atom-coupled-to-dissipative-single-mode-cavity-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Two-level-atom-coupled-to-dissipative-single-mode-cavity" title="Permalink"></a></h2><p>Consider a two-level atom coupled to a dissipative single-mode cavity through a dipole-type interaction, which supports a coherent exchange of quanta between the two systems. If the atom initially is in its ground state and the cavity in a <code>5</code>-photon <a href="../../../api/#QuantumToolbox.fock"><code>fock</code></a> state, the dynamics is calculated with the following code:</p><div class="admonition is-info"><header class="admonition-header">Generate Liouviilian superoperator manually</header><div class="admonition-body"><p>In this example, we demonstrate how to generate the Liouvillian <a href="../../../api/#QuantumToolbox.SuperOperator"><code>SuperOperator</code></a> manually and pass it as the first argument of the <a href="../../../api/#QuantumToolbox.mesolve"><code>mesolve</code></a> function.</p></div></div><pre><code class="language-julia hljs"># two-level atom
σm = tensor(destroy(2), qeye(10))
H_a = 2 * π * σm&#39; * σm

# dissipative single-mode cavity
γ = 0.1 # dissipation rate
a  = tensor(qeye(2), destroy(10))
H_c = 2 * π * a&#39; * a
c_ops = [sqrt(γ) * a]

# coupling between two-level atom and single-mode cavity
g = 0.25 # coupling strength
H_I = 2 * π * g * (σm * a&#39; + σm&#39; * a)

ψ0 = tensor(basis(2,0), fock(10, 5)) # initial state
tlist = LinRange(0.0, 10.0, 200)

# generate Liouvillian superoperator manually
L = liouvillian(H_a + H_c + H_I, c_ops)
sol = mesolve(L, ψ0, tlist, e_ops=[σm&#39; * σm, a&#39; * a])

times = sol.times

# expectation value of Number operator
N_atom   = real(sol.expect[1,:])
N_cavity = real(sol.expect[2,:])

fig = Figure(size = (500, 350))
ax = Axis(fig[1, 1], xlabel = &quot;Time&quot;, ylabel = &quot;Expectation values&quot;)
lines!(ax, times, N_atom, label = &quot;atom excitation probability&quot;, linestyle = :solid)
lines!(ax, times, N_cavity, label = &quot;cavity photon number&quot;, linestyle = :dash)

axislegend(ax, position = :rt)

fig</code></pre><img src="794f4e50.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../sesolve/">« Schrödinger Equation Solver</a><a class="docs-footer-nextpage" href="../mcsolve/">Monte-Carlo Solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 10 October 2024 00:09">Thursday 10 October 2024</span>. Using Julia version 1.11.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
