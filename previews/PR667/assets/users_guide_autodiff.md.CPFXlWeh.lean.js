import{_ as d,o as e,c as s,aA as l,j as t,a as C}from"./chunks/framework.CleWuXpX.js";const M2=JSON.parse('{"title":"Automatic Differentiation","description":"","frontmatter":{},"headers":[],"relativePath":"users_guide/autodiff.md","filePath":"users_guide/autodiff.md","lastUpdated":null}'),n={name:"users_guide/autodiff.md"},i={class:"MathJax",jax:"SVG",overflow:"linebreak"},r={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.446ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 639 1000"},m={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"15.975ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 7060.8 1000"},o={class:"mjx-scroll-wrapper"},h={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},g={style:{"vertical-align":"-0.667ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.367ex",height:"3.084ex",role:"img",focusable:"false",viewBox:"0 -1068 12096.4 1363"},p={class:"mjx-scroll-wrapper"},L={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true",width:"full",style:{"min-width":"82.841ex"}},k={style:{"vertical-align":"-5.319ex","min-width":"82.841ex"},xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"11.77ex",role:"img",focusable:"false","data-mjx-viewBox":"0 -2851.2 36615.9 5202.4"},c={class:"MathJax",jax:"SVG",overflow:"linebreak"},x={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.446ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 639 644"},f={class:"MathJax",jax:"SVG",overflow:"linebreak"},E={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637"},u={class:"MathJax",jax:"SVG",overflow:"linebreak"},y={style:{"vertical-align":"-0.05ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.726ex",height:"2.514ex",role:"img",focusable:"false",viewBox:"0 -1089 763 1111"},M={class:"MathJax",jax:"SVG",overflow:"linebreak"},D={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637"},_={class:"mjx-scroll-wrapper"},v={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},w={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.242ex",height:"3.029ex",role:"img",focusable:"false",viewBox:"0 -1089 10714.9 1339"},b={class:"MathJax",jax:"SVG",overflow:"linebreak"},Z={style:{"vertical-align":"-0.439ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.446ex",height:"1.457ex",role:"img",focusable:"false",viewBox:"0 -450 639 644"},F={class:"MathJax",jax:"SVG",overflow:"linebreak"},A={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"0.817ex",height:"1.441ex",role:"img",focusable:"false",viewBox:"0 -626 361 637"},T={class:"mjx-scroll-wrapper"},j={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},B={style:{"vertical-align":"-2.219ex"},xmlns:"http://www.w3.org/2000/svg",width:"30.779ex",height:"6.289ex",role:"img",focusable:"false",viewBox:"0 -1799 13604.2 2780"},S={class:"mjx-scroll-wrapper"},R={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},O={style:{"vertical-align":"-0.785ex"},xmlns:"http://www.w3.org/2000/svg",width:"24.542ex",height:"3.199ex",role:"img",focusable:"false",viewBox:"0 -1067 10847.7 1414"},V={class:"MathJax",jax:"SVG",overflow:"linebreak"},P={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.885ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 833 1000"},I={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.784ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2114.3 1000"},X={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.69ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2072.9 1000"},q={class:"MathJax",jax:"SVG",overflow:"linebreak"},N={style:{"vertical-align":"0"},xmlns:"http://www.w3.org/2000/svg",width:"1.699ex",height:"1.538ex",role:"img",focusable:"false",viewBox:"0 -680 751 680"},J={class:"MathJax",jax:"SVG",overflow:"linebreak"},G={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.197ex",height:"1.894ex",role:"img",focusable:"false",viewBox:"0 -826 529 837"},H={class:"MathJax",jax:"SVG",overflow:"linebreak"},Q={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"2.095ex",height:"1.974ex",role:"img",focusable:"false",viewBox:"0 -861.5 926 872.5"},z={class:"MathJax",jax:"SVG",overflow:"linebreak"},W={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.541ex",height:"2.982ex",role:"img",focusable:"false",viewBox:"0 -1068 681 1318"},$={style:{"vertical-align":"-0.722ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.744ex",height:"2.59ex",role:"img",focusable:"false",viewBox:"0 -826 2980.8 1145"},U={class:"MathJax",jax:"SVG",overflow:"linebreak"},Y={style:{"vertical-align":"-0.486ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.229ex",height:"1.486ex",role:"img",focusable:"false",viewBox:"0 -442 543 657"},K={class:"MathJax",jax:"SVG",overflow:"linebreak"},a2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.061ex",height:"2.434ex",role:"img",focusable:"false",viewBox:"0 -826 1795 1076"},t2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"7.669ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 3389.8 1000"},C2={class:"MathJax",jax:"SVG",overflow:"linebreak"},e2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.446ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 639 1000"},s2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.973ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4850.1 1000"},l2={class:"MathJax",jax:"SVG",overflow:"linebreak"},d2={style:{"vertical-align":"-0.65ex"},xmlns:"http://www.w3.org/2000/svg",width:"12.295ex",height:"2.599ex",role:"img",focusable:"false",viewBox:"0 -861.5 5434.5 1148.7"},n2={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.033ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2666.8 1000"},i2={class:"mjx-scroll-wrapper"},r2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},m2={style:{"vertical-align":"-3.019ex"},xmlns:"http://www.w3.org/2000/svg",width:"19.802ex",height:"6.435ex",role:"img",focusable:"false",viewBox:"0 -1509.9 8752.6 2844.3"},o2={class:"mjx-scroll-wrapper"},h2={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},g2={style:{"vertical-align":"-6.757ex"},xmlns:"http://www.w3.org/2000/svg",width:"27.005ex",height:"14.645ex",role:"img",focusable:"false",viewBox:"0 -3486.5 11936.2 6473"},p2={class:"MathJax",jax:"SVG",overflow:"linebreak"},L2={style:{"vertical-align":"-0.357ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.982ex",height:"1.773ex",role:"img",focusable:"false",viewBox:"0 -626 1759.9 783.8"};function k2(c2,a,x2,f2,E2,u2){return e(),s("div",null,[a[76]||(a[76]=l("",9)),t("p",null,[a[3]||(a[3]=C("One of the primary use cases for automatic differentiation in ",-1)),a[4]||(a[4]=t("code",null,"QuantumToolbox.jl",-1)),a[5]||(a[5]=C(" is the differentiation of the master equation. The master equation describes the time evolution of a quantum system's density matrix under the influence of non-unitary dynamics, such as dissipation and decoherence. Let's consider a set of parameters ",-1)),t("mjx-container",i,[(e(),s("svg",r,[...a[0]||(a[0]=[l("",1)])])),a[2]||(a[2]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",m,[...a[1]||(a[1]=[l("",1)])]))]),a[6]||(a[6]=C(" that influence the system's dynamics. The Hamiltonian and the dissipators will depend on these parameters",-1))]),t("div",o,[t("mjx-container",h,[(e(),s("svg",g,[...a[7]||(a[7]=[l("",1)])]))])]),a[77]||(a[77]=t("p",null,[C("Hence, the density matrix will evolve according to the master equation "),t("span",{id:"eq:master-equation"})],-1)),t("div",p,[t("mjx-container",L,[(e(),s("svg",k,[...a[8]||(a[8]=[l("",1)])]))])]),t("p",null,[a[11]||(a[11]=C("which depends on the parameters ",-1)),t("mjx-container",c,[(e(),s("svg",x,[...a[9]||(a[9]=[l("",1)])]))]),a[12]||(a[12]=C(" and time ",-1)),t("mjx-container",f,[(e(),s("svg",E,[...a[10]||(a[10]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"t"},[t("g",{"data-mml-node":"mi","data-latex":"t"},[t("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])]))]),a[13]||(a[13]=C(".",-1))]),t("p",null,[a[16]||(a[16]=C("We now want to compute the expectation value of an observable ",-1)),t("mjx-container",u,[(e(),s("svg",y,[...a[14]||(a[14]=[l("",1)])]))]),a[17]||(a[17]=C(" at time ",-1)),t("mjx-container",M,[(e(),s("svg",D,[...a[15]||(a[15]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"t"},[t("g",{"data-mml-node":"mi","data-latex":"t"},[t("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])]))]),a[18]||(a[18]=C(":",-1))]),t("div",_,[t("mjx-container",v,[(e(),s("svg",w,[...a[19]||(a[19]=[l("",1)])]))])]),t("p",null,[a[22]||(a[22]=C("which will also depend on the parameters ",-1)),t("mjx-container",b,[(e(),s("svg",Z,[...a[20]||(a[20]=[l("",1)])]))]),a[23]||(a[23]=C(" and time ",-1)),t("mjx-container",F,[(e(),s("svg",A,[...a[21]||(a[21]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"t"},[t("g",{"data-mml-node":"mi","data-latex":"t"},[t("path",{"data-c":"1D461",d:"M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"})])])],-1)])]))]),a[24]||(a[24]=C(".",-1))]),a[78]||(a[78]=t("p",null,"Our goal is to compute the derivative of the expectation value with respect to the parameters:",-1)),t("div",T,[t("mjx-container",j,[(e(),s("svg",B,[...a[25]||(a[25]=[l("",1)])]))])]),a[79]||(a[79]=t("p",null,[C("and to achieve this, we can use an AD engine like "),t("a",{href:"https://github.com/JuliaDiff/ForwardDiff.jl",target:"_blank",rel:"noreferrer"},[t("code",null,"ForwardDiff.jl")]),C(" (forward mode) or "),t("a",{href:"https://github.com/FluxML/Zygote.jl",target:"_blank",rel:"noreferrer"},[t("code",null,"Zygote.jl")]),C(" (reverse mode).")],-1)),a[80]||(a[80]=t("p",null,"Let's apply this to a simple example of a driven-dissipative quantum harmonic oscillator. The Hamiltonian in the drive frame is given by",-1)),t("div",S,[t("mjx-container",R,[(e(),s("svg",O,[...a[26]||(a[26]=[l("",1)])]))])]),t("p",null,[a[42]||(a[42]=C("where ",-1)),t("mjx-container",V,[(e(),s("svg",P,[...a[27]||(a[27]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"\\Delta = \\omega_0 - \\omega_d"},[t("g",{"data-mml-node":"mi","data-latex":"\\Delta"},[t("path",{"data-c":"394",d:"M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"})])])],-1)])])),a[30]||(a[30]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",I,[...a[28]||(a[28]=[l("",1)])])),a[31]||(a[31]=t("mjx-break",{size:"3"}," ",-1)),(e(),s("svg",X,[...a[29]||(a[29]=[l("",1)])]))]),a[43]||(a[43]=C(" is the cavity-drive detuning, ",-1)),t("mjx-container",q,[(e(),s("svg",N,[...a[32]||(a[32]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"F"},[t("g",{"data-mml-node":"mi","data-latex":"F"},[t("path",{"data-c":"1D439",d:"M199 656C199 646 210 641 231 641C271 641 291 637 291 628C291 625 289 618 286 605L156 82C150 60 140 47 126 42C119 40 101 39 70 39C48 39 38 37 38 16C38 5 44 0 57 0L187 3L335 0C351 0 359 8 359 23C359 40 348 39 322 39C278 39 253 41 247 46C244 47 243 51 243 56L307 321L400 321C446 321 478 319 478 281C478 268 476 252 471 233C470 230 469 226 468 222C468 211 473 206 484 206C489 207 496 214 503 229L557 444C559 452 560 458 560 461C557 470 551 475 544 475C536 475 530 467 526 452C516 414 502 390 486 378C470 366 442 360 402 360L317 360L379 606C387 640 387 641 429 641L559 641C656 641 700 626 700 537C700 517 699 499 697 484C696 473 695 467 695 466C695 455 700 450 710 450C720 450 726 459 728 478L748 649C751 677 744 680 717 680L233 680C210 680 199 679 199 656Z"})])])],-1)])]))]),a[44]||(a[44]=C(" is the drive strength, and ",-1)),t("mjx-container",J,[(e(),s("svg",G,[...a[33]||(a[33]=[l("",1)])]))]),a[45]||(a[45]=C(" and ",-1)),t("mjx-container",H,[(e(),s("svg",Q,[...a[34]||(a[34]=[l("",1)])]))]),a[46]||(a[46]=C(" are the annihilation and creation operators, respectively. The system is subject to a single dissipative channel with a Lindblad operator ",-1)),t("mjx-container",z,[(e(),s("svg",W,[...a[35]||(a[35]=[l("",1)])])),a[37]||(a[37]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",$,[...a[36]||(a[36]=[l("",1)])]))]),a[47]||(a[47]=C(", where ",-1)),t("mjx-container",U,[(e(),s("svg",Y,[...a[38]||(a[38]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"\\gamma"},[t("g",{"data-mml-node":"mi","data-latex":"\\gamma"},[t("path",{"data-c":"1D6FE",d:"M524 378C537 403 543 416 543 417C543 426 538 431 527 431C520 431 515 428 512 422C477 357 436 265 388 146C384 212 371 274 349 331C320 405 275 442 214 442C151 442 96 400 68 361C35 314 18 279 18 257C18 248 26 243 43 243L48 250C65 302 94 335 135 349C163 358 185 363 201 363C305 363 357 281 357 116C357 77 353 45 345 20C311-91 294-162 294-193C294-208 300-215 311-215C323-215 335-194 346-153C363-89 375-32 382 18C385 33 387 46 390 55C426 167 471 275 524 378Z"})])])],-1)])]))]),a[48]||(a[48]=C(" is the dissipation rate. If we start from the ground state ",-1)),t("mjx-container",K,[(e(),s("svg",a2,[...a[39]||(a[39]=[l("",1)])])),a[41]||(a[41]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",t2,[...a[40]||(a[40]=[l("",1)])]))]),a[49]||(a[49]=C(", the systems evolves according to the master equation in ",-1)),a[50]||(a[50]=t("a",{href:"/QuantumToolbox.jl/previews/PR667/users_guide/autodiff#eq:master-equation"},"Eq. (1)",-1)),a[51]||(a[51]=C(".",-1))]),t("p",null,[a[58]||(a[58]=C("We now want to study the number of photons at the steady state, and how it varies with ",-1)),t("mjx-container",C2,[(e(),s("svg",e2,[...a[52]||(a[52]=[l("",1)])])),a[54]||(a[54]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",s2,[...a[53]||(a[53]=[l("",1)])]))]),a[59]||(a[59]=C(", namely ",-1)),t("mjx-container",l2,[(e(),s("svg",d2,[...a[55]||(a[55]=[l("",1)])])),a[57]||(a[57]=t("mjx-break",{size:"4"}," ",-1)),(e(),s("svg",n2,[...a[56]||(a[56]=[l("",1)])]))]),a[60]||(a[60]=C(". We can extract an analytical expression, in order to verify the correctness of the AD implementation:",-1))]),t("div",i2,[t("mjx-container",r2,[(e(),s("svg",m2,[...a[61]||(a[61]=[l("",1)])]))])]),a[81]||(a[81]=t("p",null,"with the gradient given by",-1)),t("div",o2,[t("mjx-container",h2,[(e(),s("svg",g2,[...a[62]||(a[62]=[l("",1)])]))])]),t("p",null,[a[64]||(a[64]=C("Although ",-1)),a[65]||(a[65]=t("code",null,"QuantumToolbox.jl",-1)),a[66]||(a[66]=C(" has the ",-1)),a[67]||(a[67]=t("a",{href:"/QuantumToolbox.jl/previews/PR667/resources/api#QuantumToolbox.steadystate"},[t("code",null,"steadystate")],-1)),a[68]||(a[68]=C(" function to directly compute the steady state without explicitly solving the master equation, here we use the ",-1)),a[69]||(a[69]=t("a",{href:"/QuantumToolbox.jl/previews/PR667/resources/api#QuantumToolbox.mesolve"},[t("code",null,"mesolve")],-1)),a[70]||(a[70]=C(" function to integrate up to a long time ",-1)),t("mjx-container",p2,[(e(),s("svg",L2,[...a[63]||(a[63]=[l("",1)])]))]),a[71]||(a[71]=C(", and then compute the expectation value of the number operator. We will demonstrate how to compute the gradient using both ",-1)),a[72]||(a[72]=t("a",{href:"https://github.com/JuliaDiff/ForwardDiff.jl",target:"_blank",rel:"noreferrer"},[t("code",null,"ForwardDiff.jl")],-1)),a[73]||(a[73]=C(" and ",-1)),a[74]||(a[74]=t("a",{href:"https://github.com/FluxML/Zygote.jl",target:"_blank",rel:"noreferrer"},[t("code",null,"Zygote.jl")],-1)),a[75]||(a[75]=C(".",-1))]),a[82]||(a[82]=l("",27))])}const D2=d(n,[["render",k2]]);export{M2 as __pageData,D2 as default};
