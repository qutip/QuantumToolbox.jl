<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time Evolution Solutions · QuantumToolbox.jl</title><meta name="title" content="Time Evolution Solutions · QuantumToolbox.jl"/><meta property="og:title" content="Time Evolution Solutions · QuantumToolbox.jl"/><meta property="twitter:title" content="Time Evolution Solutions · QuantumToolbox.jl"/><meta name="description" content="Documentation for QuantumToolbox.jl."/><meta property="og:description" content="Documentation for QuantumToolbox.jl."/><meta property="twitter:description" content="Documentation for QuantumToolbox.jl."/><meta property="og:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/solution/"/><meta property="twitter:url" content="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/solution/"/><link rel="canonical" href="https://qutip.github.io/QuantumToolbox.jl/users_guide/time_evolution/solution/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="QuantumToolbox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">QuantumToolbox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../">Introduction</a></li><li><a class="tocitem" href="../../../qutip_differences/">Key differences from QuTiP</a></li><li><a class="tocitem" href="../../../type_stability/">The Importance of Type-Stability</a></li></ul></li><li><span class="tocitem">Users Guide</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Basic Operations on Quantum Objects</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../QuantumObject/QuantumObject/">Quantum Objects (Qobj)</a></li><li><a class="tocitem" href="../../QuantumObject/QuantumObject_functions/">Functions operating on Qobj</a></li></ul></li><li><a class="tocitem" href="../../states_and_operators/">Manipulating States and Operators</a></li><li><a class="tocitem" href="../../tensor/">Tensor Products and Partial Traces</a></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox" checked/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">Time Evolution and Dynamics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../intro/">Introduction</a></li><li class="is-active"><a class="tocitem" href>Time Evolution Solutions</a><ul class="internal"><li><a class="tocitem" href="#Solution"><span>Solution</span></a></li><li><a class="tocitem" href="#Accessing-data-in-solutions"><span>Accessing data in solutions</span></a></li><li><a class="tocitem" href="#Multiple-trajectories-solution"><span>Multiple trajectories solution</span></a></li></ul></li><li><a class="tocitem" href="../sesolve/">Schrödinger Equation Solver</a></li><li><a class="tocitem" href="../mesolve/">Lindblad Master Equation Solver</a></li><li><a class="tocitem" href="../mcsolve/">Monte-Carlo Solver</a></li><li><a class="tocitem" href="../stochastic/">Stochastic Solver</a></li><li><a class="tocitem" href="../time_dependent/">Solving Problems with Time-dependent Hamiltonians</a></li></ul></li><li><a class="tocitem" href="../../steadystate/">Solving for Steady-State Solutions</a></li><li><span class="tocitem">Symmetries</span></li><li><span class="tocitem">Two-time correlation functions</span></li><li><input class="collapse-toggle" id="menuitem-2-8" type="checkbox"/><label class="tocitem" for="menuitem-2-8"><span class="docs-label">Extensions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../extensions/cuda/">Extension for CUDA.jl</a></li></ul></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Time Evolution</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/lowrank/">Low Rank Master Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Miscellaneous Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../tutorials/logo/">Create QuantumToolbox.jl logo</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../api/">API</a></li><li><a class="tocitem" href="../../../bibliography/">Bibliography</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Users Guide</a></li><li><a class="is-disabled">Time Evolution and Dynamics</a></li><li class="is-active"><a href>Time Evolution Solutions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time Evolution Solutions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/qutip/QuantumToolbox.jl/blob/main/docs/src/users_guide/time_evolution/solution.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="doc-TE:Time-Evolution-Solutions"><a class="docs-heading-anchor" href="#doc-TE:Time-Evolution-Solutions">Time Evolution Solutions</a><a id="doc-TE:Time-Evolution-Solutions-1"></a><a class="docs-heading-anchor-permalink" href="#doc-TE:Time-Evolution-Solutions" title="Permalink"></a></h1><h2 id="Solution"><a class="docs-heading-anchor" href="#Solution">Solution</a><a id="Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Solution" title="Permalink"></a></h2><p><code>QuantumToolbox</code> utilizes the powerful <a href="https://docs.sciml.ai/DiffEqDocs/stable/"><code>DifferentialEquation.jl</code></a> to simulate different kinds of quantum system dynamics. Thus, we will first look at the data structure used for returning the solution (<code>sol</code>) from <a href="https://docs.sciml.ai/DiffEqDocs/stable/"><code>DifferentialEquation.jl</code></a>. The solution stores all the crucial data needed for analyzing and plotting the results of a simulation. A generic structure <a href="../../../api/#QuantumToolbox.TimeEvolutionSol"><code>TimeEvolutionSol</code></a> contains the following properties for storing simulation data:</p><table><tr><th style="text-align: left"><strong>Fields (Attributes)</strong></th><th style="text-align: left"><strong>Description</strong></th></tr><tr><td style="text-align: left"><code>sol.times</code></td><td style="text-align: left">The time list of the evolution.</td></tr><tr><td style="text-align: left"><code>sol.states</code></td><td style="text-align: left">The list of result states.</td></tr><tr><td style="text-align: left"><code>sol.expect</code></td><td style="text-align: left">The expectation values corresponding to each time point in <code>sol.times</code>.</td></tr><tr><td style="text-align: left"><code>sol.alg</code></td><td style="text-align: left">The algorithm which is used during the solving process.</td></tr><tr><td style="text-align: left"><code>sol.abstol</code></td><td style="text-align: left">The absolute tolerance which is used during the solving process.</td></tr><tr><td style="text-align: left"><code>sol.reltol</code></td><td style="text-align: left">The relative tolerance which is used during the solving process.</td></tr><tr><td style="text-align: left"><code>sol.retcode</code> (or <code>sol.converged</code>)</td><td style="text-align: left">The returned status from the solver.</td></tr></table><h2 id="Accessing-data-in-solutions"><a class="docs-heading-anchor" href="#Accessing-data-in-solutions">Accessing data in solutions</a><a id="Accessing-data-in-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Accessing-data-in-solutions" title="Permalink"></a></h2><p>To understand how to access the data in solution, we will use an example as a guide, although we do not worry about the simulation details at this stage. The Schrödinger equation solver (<a href="../../../api/#QuantumToolbox.sesolve"><code>sesolve</code></a>) used in this example returns <a href="../../../api/#QuantumToolbox.TimeEvolutionSol"><code>TimeEvolutionSol</code></a>:</p><pre><code class="language-julia hljs">H = 0.5 * sigmay()
ψ0 = basis(2, 0)
e_ops = [
    proj(basis(2, 0)),
    proj(basis(2, 1)),
    basis(2, 0) * basis(2, 1)&#39;
]
tlist = LinRange(0, 10, 100)
sol = sesolve(H, ψ0, tlist, e_ops = e_ops, progress_bar = Val(false))</code></pre><p>To see what is contained inside the solution, we can use the <code>print</code> function:</p><pre><code class="language-julia hljs">print(sol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Solution of time evolution
(return code: Success)
--------------------------
num_states = 1
num_expect = 3
ODE alg.: OrdinaryDiffEqTsit5.Tsit5{typeof(OrdinaryDiffEqCore.trivial_limiter!), typeof(OrdinaryDiffEqCore.trivial_limiter!), Static.False}(OrdinaryDiffEqCore.trivial_limiter!, OrdinaryDiffEqCore.trivial_limiter!, static(false))
abstol = 1.0e-8
reltol = 1.0e-6</code></pre><p>It tells us the number of expectation values are computed and the number of states are stored. Now we have all the information needed to analyze the simulation results. To access the data for the three expectation values, one can do:</p><pre><code class="language-julia hljs">expt1 = real(sol.expect[1,:])
expt2 = real(sol.expect[2,:])
expt3 = real(sol.expect[3,:])</code></pre><p>Recall that <code>Julia</code> uses <code>Fortran</code>-style indexing that begins with one (i.e., <code>[1,:]</code> represents the 1-st observable, where <code>:</code> represents all values corresponding to <code>tlist</code>).</p><p>Together with the array of times at which these expectation values are calculated:</p><pre><code class="language-julia hljs">times = sol.times</code></pre><p>we can plot the resulting expectation values:</p><pre><code class="language-julia hljs">using CairoMakie
CairoMakie.enable_only_mime!(MIME&quot;image/svg+xml&quot;())

fig = Figure(size = (500, 350))
ax = Axis(fig[1, 1], xlabel = L&quot;t&quot;)
lines!(ax, times, expt1, label = L&quot;\langle 0 | \rho(t) | 0 \rangle&quot;)
lines!(ax, times, expt2, label = L&quot;\langle 1 | \rho(t) | 1 \rangle&quot;)
lines!(ax, times, expt3, label = L&quot;\langle 0 | \rho(t) | 1 \rangle&quot;)

ylims!(ax, (-0.5, 1.0))
axislegend(ax, position = :lb)

fig</code></pre><img src="0e8309a7.svg" alt="Example block output"/><p>State vectors, or density matrices, are accessed in a similar manner:</p><pre><code class="language-julia hljs">sol.states</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{QuantumObject{Vector{ComplexF64}, KetQuantumObject, 1}}:
 Quantum Object:   type=Ket   dims=[2]   size=(2,)
2-element Vector{ComplexF64}:
 0.28366218546240907 + 0.0im
 -0.9589242745990754 + 0.0im</code></pre><p>Here, the solution contains only one (final) state. Because the <code>states</code> will be saved depend on the keyword argument <code>saveat</code> in <code>kwargs</code>. If <code>e_ops</code> is empty, the default value of <code>saveat=tlist</code> (saving the states corresponding to <code>tlist</code>), otherwise, <code>saveat=[tlist[end]]</code> (only save the final state). One can also specify <code>e_ops</code> and <code>saveat</code> separately.</p><p>Some other solvers can have other output.</p><h2 id="Multiple-trajectories-solution"><a class="docs-heading-anchor" href="#Multiple-trajectories-solution">Multiple trajectories solution</a><a id="Multiple-trajectories-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-trajectories-solution" title="Permalink"></a></h2><p>This part is still under construction, please visit <a href="../../../api/#doc-API">API</a> first.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../intro/">« Introduction</a><a class="docs-footer-nextpage" href="../sesolve/">Schrödinger Equation Solver »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 31 October 2024 10:37">Thursday 31 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
